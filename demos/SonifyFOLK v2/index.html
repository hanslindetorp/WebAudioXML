<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Gesture Controlled Music - By Hans Lindetorp</title>
    <link rel="stylesheet" type="text/css" href="style/style.css">

    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/holistic/holistic.js" crossorigin="anonymous"></script>
    
    <script type="text/javascript" src="script/max.size.js"></script>
  </head>

  <body>
    <main class="pages">

      <section id="play">
        <video class="input_video" width="1000" height="567.5"></video>
        <canvas class="output_canvas" width="1000" height="567.5"></canvas>

        <div class="slider-container">
          <div>
            <h3>Filter
              <input type="range" min="0" max="1" step="0.01" value="0" data-waxml-input-set="f0=this.value" />
            </h3>
            
            <label>Arm:
              <input type="range" min="0" max="1" step="0.01" value="0" data-waxml-input-set="arm_filter=this.value" />
            </label>
            <label>Shoulder:
              <input type="range" min="0" max="1" step="0.01" value="0" data-waxml-input-set="shoulder_filter=this.value" />
            </label>
            <label>Hip:
              <input type="range" min="0" max="1" step="0.01" value="0" data-waxml-input-set="hip_filter=this.value" />
            </label>
            <label>Foot:
              <input type="range" min="0" max="1" step="0.01" value="0" data-waxml-input-set="foot_filter=this.value" />
            </label>
          </div>
          <div>
            <h3>Gain
              <input type="range" min="0" max="1" step="0.01" value="0" data-waxml-input-set="g0=this.value" />
            </h3>
            
            <label>Arm:
              <input type="range" min="0" max="1" step="0.01" value="0" data-waxml-input-set="arm_gain=this.value" />
            </label>
            <label>Shoulder:
              <input type="range" min="0" max="1" step="0.01" value="0" data-waxml-input-set="shoulder_gain=this.value" />
            </label>
            <label>Hip:
              <input type="range" min="0" max="1" step="0.01" value="0" data-waxml-input-set="hip_gain=this.value" />
            </label>
            <label>Foot:
              <input type="range" min="0" max="1" step="0.01" value="0" data-waxml-input-set="foot_gain=this.value" />
            </label>
          </div>
        </div>
      </section>

      <section id="share">
        <textarea id="shareURL"></textarea>
      </section>

      <section id="help">
        <iframe width="560" height="315" src="https://www.youtube.com/embed/oWN0h7OBxB8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        
        <p>This DEMO shows how music (or any type of sound) can be controlled with gestures on a standard web page.
          It is built with a library called MediaPipe - <a href="https://google.github.io/mediapipe/">https://google.github.io/mediapipe/</a> 
          for tracking a body from a video signal.</p>
          <p>The X, Y, and Z locations of all tracked points are then fed into 
          an adaptive mixer built with WebAudioXML - <a href="https://github.com/hanslindetorp/WebAudioXML">https://github.com/hanslindetorp/WebAudioXML</a>
          Both technologies are freely available for use on any web page. 
          The inspiration for this DEMO comes from <a href="https://github.com/monlim/Handmate-MIDI">Handmate-MIDI</a>.
      </p>

      <p>This application is part of a research project at the <a href="https://www.kmh.se/">Royal College 
        of Music</a> and the <a href="https://www.kth.se/">Royal Institute of Technology</a> in Stockholm by 
        Hans Lindetorp. Please follow my blog at <a href="https://hans.arapoviclindetorp.se/">hans.arapoviclindetorp.se</a></p>
      </section>

      <navigation>
        
        <div id="musicControl">
          Music<input id="playMusicBtn" type="checkbox" data-waxml-change-set="gain=this.checked" />
        </div>
        <a id="playBtn" href="#play">Close</a>
        <a id="helpBtn" href="#help">Info</a>
       
        <h1>Gesture Controlled Music - hans.lindetorp@kmh.se</h1>
      </navigation>
      
    </main>

    <script src="script/WebAudioXML.js" data-source="audio-config.xml"></script>
    <script type="text/javascript" src="script/script.js"></script>
    <script type="text/javascript" src="script/HolisticController.js"></script>
    <script type="text/javascript" src="script/holistic.js"></script>
  </body>
</html>
